<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŒäººè´ªåƒè›‡å¤§ä½œæˆ˜</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Arial', sans-serif;
            display: flex;
            flex-direction: column;
            align-items: center;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            color: white;
            min-height: 100vh;
            padding: 20px;
        }
        
        h1 {
            text-shadow: 0 0 20px #00ffff, 0 0 40px #ff00ff;
            margin: 20px 0;
            font-size: 2.5em;
            animation: neonGlow 2s ease-in-out infinite alternate;
        }
        
        @keyframes neonGlow {
            from { text-shadow: 0 0 10px #00ffff, 0 0 20px #ff00ff; }
            to { text-shadow: 0 0 20px #00ffff, 0 0 40px #ff00ff, 0 0 60px #00ffff; }
        }
        
        .game-container {
            display: flex;
            gap: 30px;
            align-items: flex-start;
            margin: 20px 0;
        }
        
        .player-info {
            background: rgba(0, 0, 0, 0.5);
            padding: 20px;
            border-radius: 15px;
            min-width: 200px;
            backdrop-filter: blur(10px);
        }
        
        .player1-info {
            border: 3px solid #4cc9f0;
            box-shadow: 0 0 20px rgba(76, 201, 240, 0.5);
        }
        
        .player2-info {
            border: 3px solid #f72585;
            box-shadow: 0 0 20px rgba(247, 37, 133, 0.5);
        }
        
        .player-name {
            font-size: 1.5em;
            font-weight: bold;
            margin-bottom: 15px;
            text-align: center;
        }
        
        .player1-name {
            color: #4cc9f0;
            text-shadow: 0 0 10px #4cc9f0;
        }
        
        .player2-name {
            color: #f72585;
            text-shadow: 0 0 10px #f72585;
        }
        
        .stat {
            margin: 10px 0;
            font-size: 1.1em;
        }
        
        .controls-info {
            margin-top: 15px;
            padding-top: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
            font-size: 0.9em;
            color: #aaa;
        }
        
        #gameCanvas {
            border: 4px solid #4a4e69;
            border-radius: 15px;
            box-shadow: 0 0 40px rgba(0, 255, 255, 0.6);
            background: #0f0f1a;
        }
        
        .controls {
            display: flex;
            gap: 20px;
            margin: 20px 0;
        }
        
        button {
            padding: 15px 35px;
            font-size: 18px;
            background: linear-gradient(45deg, #4cc9f0, #f72585);
            border: none;
            border-radius: 30px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(76, 201, 240, 0.5);
            font-weight: bold;
        }
        
        button:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 25px rgba(76, 201, 240, 0.7);
        }
        
        button:active {
            transform: translateY(0);
        }
        
        #gameOver {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0, 0, 0, 0.95);
            padding: 50px 80px;
            border-radius: 30px;
            border: 4px solid;
            box-shadow: 0 0 60px;
            display: none;
            text-align: center;
            z-index: 1000;
            min-width: 400px;
        }
        
        #gameOver.show {
            display: block;
            animation: victoryIn 0.5s ease-out;
        }
        
        @keyframes victoryIn {
            0% { transform: translate(-50%, -50%) scale(0) rotate(360deg); }
            100% { transform: translate(-50%, -50%) scale(1) rotate(0deg); }
        }
        
        .instructions {
            background: rgba(0, 0, 0, 0.5);
            padding: 20px 30px;
            border-radius: 15px;
            max-width: 800px;
            text-align: center;
            backdrop-filter: blur(10px);
        }
        
        .instructions p {
            margin: 8px 0;
            font-size: 0.95em;
        }
        
        .mode-selector {
            display: flex;
            gap: 15px;
            margin: 20px 0;
        }
        
        .mode-btn {
            padding: 10px 25px;
            font-size: 16px;
            background: rgba(255, 255, 255, 0.1);
            border: 2px solid white;
            border-radius: 25px;
            color: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .mode-btn.active {
            background: linear-gradient(45deg, #4cc9f0, #f72585);
            box-shadow: 0 0 20px rgba(76, 201, 240, 0.6);
        }
    </style>
</head>
<body>
    <h1>ğŸ åŒäººè´ªåƒè›‡å¤§ä½œæˆ˜ ğŸ</h1>
    
    <div class="mode-selector">
        <button class="mode-btn active" data-mode="pvp">åŒäººå¯¹æˆ˜</button>
        <button class="mode-btn" data-mode="ai">å•äºº vs AI</button>
    </div>
    
    <div class="game-container">
        <div class="player-info player1-info">
            <div class="player-name player1-name">ç©å®¶ 1</div>
            <div class="stat">é•¿åº¦: <span id="p1-length">3</span></div>
            <div class="stat">åˆ†æ•°: <span id="p1-score">0</span></div>
            <div class="stat">é£Ÿç‰©: <span id="p1-food">0</span></div>
            <div class="controls-info">
                <strong>æ§åˆ¶:</strong><br>
                W - ä¸Š<br>
                S - ä¸‹<br>
                A - å·¦<br>
                D - å³
            </div>
        </div>
        
        <canvas id="gameCanvas" width="800" height="600"></canvas>
        
        <div class="player-info player2-info">
            <div class="player-name player2-name" id="p2-name">ç©å®¶ 2</div>
            <div class="stat">é•¿åº¦: <span id="p2-length">3</span></div>
            <div class="stat">åˆ†æ•°: <span id="p2-score">0</span></div>
            <div class="stat">é£Ÿç‰©: <span id="p2-food">0</span></div>
            <div class="controls-info">
                <strong>æ§åˆ¶:</strong><br>
                â†‘ - ä¸Š<br>
                â†“ - ä¸‹<br>
                â† - å·¦<br>
                â†’ - å³
            </div>
        </div>
    </div>
    
    <div class="controls">
        <button id="startBtn">å¼€å§‹æ¸¸æˆ</button>
        <button id="pauseBtn">æš‚åœ</button>
    </div>
    
    <div class="instructions">
        <p>ğŸ® ä¸¤æ¡è›‡åŒæ—¶åœ¨åœºä¸Šç«äº‰é£Ÿç‰©</p>
        <p>ğŸ åƒåˆ°é£Ÿç‰©å¢åŠ é•¿åº¦å’Œåˆ†æ•°</p>
        <p>ğŸ’€ æ’åˆ°å¢™å£ã€è‡ªå·±èº«ä½“æˆ–å¯¹æ‰‹èº«ä½“å³å¤±è´¥</p>
        <p>ğŸ† å­˜æ´»åˆ°æœ€åæˆ–å¾—åˆ†æ›´é«˜è€…è·èƒœï¼</p>
    </div>
    
    <div id="gameOver">
        <h2 id="winnerTitle" style="font-size: 3em; margin-bottom: 30px;">æ¸¸æˆç»“æŸ</h2>
        <div style="display: flex; gap: 40px; justify-content: center; margin: 20px 0;">
            <div>
                <p style="font-size: 1.8em; color: #4cc9f0; margin: 10px 0;">ç©å®¶ 1</p>
                <p style="font-size: 1.3em;">åˆ†æ•°: <span id="final-p1-score">0</span></p>
                <p style="font-size: 1.3em;">é•¿åº¦: <span id="final-p1-length">0</span></p>
            </div>
            <div>
                <p style="font-size: 1.8em; color: #f72585; margin: 10px 0;" id="final-p2-title">ç©å®¶ 2</p>
                <p style="font-size: 1.3em;">åˆ†æ•°: <span id="final-p2-score">0</span></p>
                <p style="font-size: 1.3em;">é•¿åº¦: <span id="final-p2-length">0</span></p>
            </div>
        </div>
        <button id="restartBtn" style="margin-top: 30px;">å†æ¥ä¸€å±€</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startBtn = document.getElementById('startBtn');
        const pauseBtn = document.getElementById('pauseBtn');
        const restartBtn = document.getElementById('restartBtn');
        const gameOverEl = document.getElementById('gameOver');
        const winnerTitle = document.getElementById('winnerTitle');
        const modeBtns = document.querySelectorAll('.mode-btn');
        
        const CELL_SIZE = 20;
        const COLS = canvas.width / CELL_SIZE;
        const ROWS = canvas.height / CELL_SIZE;
        
        let gameMode = 'pvp';
        
        modeBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                modeBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                gameMode = btn.dataset.mode;
                
                const p2Name = document.getElementById('p2-name');
                const finalP2Title = document.getElementById('final-p2-title');
                if (gameMode === 'ai') {
                    p2Name.textContent = 'AI';
                    finalP2Title.textContent = 'AI';
                } else {
                    p2Name.textContent = 'ç©å®¶ 2';
                    finalP2Title.textContent = 'ç©å®¶ 2';
                }
            });
        });
        
        let gameState = {
            running: false,
            paused: false,
            mode: 'pvp',
            player1: {
                snake: [{x: 10, y: 15}, {x: 9, y: 15}, {x: 8, y: 15}],
                direction: 'right',
                nextDirection: 'right',
                score: 0,
                foodEaten: 0,
                alive: true,
                color: '#4cc9f0'
            },
            player2: {
                snake: [{x: 30, y: 15}, {x: 31, y: 15}, {x: 32, y: 15}],
                direction: 'left',
                nextDirection: 'left',
                score: 0,
                foodEaten: 0,
                alive: true,
                color: '#f72585'
            },
            food: [],
            particles: []
        };
        
        document.addEventListener('keydown', (e) => {
            if (!gameState.running || gameState.paused) return;
            
            const p1 = gameState.player1;
            const p2 = gameState.player2;
            
            switch(e.key.toLowerCase()) {
                case 'w':
                    if (p1.direction !== 'down') p1.nextDirection = 'up';
                    break;
                case 's':
                    if (p1.direction !== 'up') p1.nextDirection = 'down';
                    break;
                case 'a':
                    if (p1.direction !== 'right') p1.nextDirection = 'left';
                    break;
                case 'd':
                    if (p1.direction !== 'left') p1.nextDirection = 'right';
                    break;
            }
            
            if (gameMode === 'pvp') {
                switch(e.key) {
                    case 'ArrowUp':
                        if (p2.direction !== 'down') p2.nextDirection = 'up';
                        e.preventDefault();
                        break;
                    case 'ArrowDown':
                        if (p2.direction !== 'up') p2.nextDirection = 'down';
                        e.preventDefault();
                        break;
                    case 'ArrowLeft':
                        if (p2.direction !== 'right') p2.nextDirection = 'left';
                        e.preventDefault();
                        break;
                    case 'ArrowRight':
                        if (p2.direction !== 'left') p2.nextDirection = 'right';
                        e.preventDefault();
                        break;
                }
            }
            
            if (e.key === ' ') {
                e.preventDefault();
                togglePause();
            }
        });
        
        startBtn.addEventListener('click', startGame);
        pauseBtn.addEventListener('click', togglePause);
        restartBtn.addEventListener('click', () => {
            gameOverEl.classList.remove('show');
            startGame();
        });
        
        function startGame() {
            gameState = {
                running: true,
                paused: false,
                mode: gameMode,
                player1: {
                    snake: [{x: 10, y: 15}, {x: 9, y: 15}, {x: 8, y: 15}],
                    direction: 'right',
                    nextDirection: 'right',
                    score: 0,
                    foodEaten: 0,
                    alive: true,
                    color: '#4cc9f0'
                },
                player2: {
                    snake: [{x: 30, y: 15}, {x: 31, y: 15}, {x: 32, y: 15}],
                    direction: 'left',
                    nextDirection: 'left',
                    score: 0,
                    foodEaten: 0,
                    alive: true,
                    color: '#f72585'
                },
                food: [],
                particles: []
            };
            
            spawnFood();
            spawnFood();
            spawnFood();
            
            updateUI();
            gameLoop();
        }
        
        function togglePause() {
            if (!gameState.running) return;
            gameState.paused = !gameState.paused;
            pauseBtn.textContent = gameState.paused ? 'ç»§ç»­' : 'æš‚åœ';
            if (!gameState.paused) gameLoop();
        }
        
        function spawnFood() {
            let x, y, valid;
            
            do {
                x = Math.floor(Math.random() * COLS);
                y = Math.floor(Math.random() * ROWS);
                valid = true;
                
                for (const segment of gameState.player1.snake) {
                    if (segment.x === x && segment.y === y) {
                        valid = false;
                        break;
                    }
                }
                
                for (const segment of gameState.player2.snake) {
                    if (segment.x === x && segment.y === y) {
                        valid = false;
                        break;
                    }
                }
                
                for (const food of gameState.food) {
                    if (food.x === x && food.y === y) {
                        valid = false;
                        break;
                    }
                }
            } while (!valid);
            
            gameState.food.push({
                x: x,
                y: y,
                color: `hsl(${Math.random() * 360}, 70%, 60%)`
            });
        }
        
        function moveSnake(player) {
            if (!player.alive) return;
            
            player.direction = player.nextDirection;
            
            const head = {...player.snake[0]};
            
            switch(player.direction) {
                case 'up': head.y--; break;
                case 'down': head.y++; break;
                case 'left': head.x--; break;
                case 'right': head.x++; break;
            }
            
            if (head.x < 0 || head.x >= COLS || head.y < 0 || head.y >= ROWS) {
                player.alive = false;
                return;
            }
            
            if (checkSelfCollision(player, head) || checkOpponentCollision(player, head)) {
                player.alive = false;
                return;
            }
            
            player.snake.unshift(head);
            
            const foodIndex = checkFoodCollision(head);
            if (foodIndex !== -1) {
                gameState.food.splice(foodIndex, 1);
                player.score += 10;
                player.foodEaten++;
                spawnFood();
                
                createParticles(head.x * CELL_SIZE + CELL_SIZE / 2, 
                               head.y * CELL_SIZE + CELL_SIZE / 2, 
                               player.color);
            } else {
                player.snake.pop();
            }
        }
        
        function aiMove() {
            if (!gameState.player2.alive || gameMode === 'pvp') return;
            
            const head = gameState.player2.snake[0];
            const closestFood = findClosestFood(head);
            
            if (!closestFood) return;
            
            const possibleDirections = [];
            
            if (gameState.player2.direction !== 'down' && head.y > closestFood.y) {
                possibleDirections.push({dir: 'up', priority: Math.abs(head.y - closestFood.y)});
            }
            if (gameState.player2.direction !== 'up' && head.y < closestFood.y) {
                possibleDirections.push({dir: 'down', priority: Math.abs(head.y - closestFood.y)});
            }
            if (gameState.player2.direction !== 'right' && head.x > closestFood.x) {
                possibleDirections.push({dir: 'left', priority: Math.abs(head.x - closestFood.x)});
            }
            if (gameState.player2.direction !== 'left' && head.x < closestFood.x) {
                possibleDirections.push({dir: 'right', priority: Math.abs(head.x - closestFood.x)});
            }
            
            if (possibleDirections.length > 0) {
                possibleDirections.sort((a, b) => b.priority - a.priority);
                
                for (const option of possibleDirections) {
                    const testHead = {...head};
                    switch(option.dir) {
                        case 'up': testHead.y--; break;
                        case 'down': testHead.y++; break;
                        case 'left': testHead.x--; break;
                        case 'right': testHead.x++; break;
                    }
                    
                    if (testHead.x >= 0 && testHead.x < COLS && 
                        testHead.y >= 0 && testHead.y < ROWS &&
                        !checkSelfCollision(gameState.player2, testHead) &&
                        !checkOpponentCollision(gameState.player2, testHead)) {
                        gameState.player2.nextDirection = option.dir;
                        return;
                    }
                }
            }
        }
        
        function findClosestFood(head) {
            let closest = null;
            let minDist = Infinity;
            
            for (const food of gameState.food) {
                const dist = Math.abs(head.x - food.x) + Math.abs(head.y - food.y);
                if (dist < minDist) {
                    minDist = dist;
                    closest = food;
                }
            }
            
            return closest;
        }
        
        function checkSelfCollision(player, head) {
            for (let i = 1; i < player.snake.length; i++) {
                if (player.snake[i].x === head.x && player.snake[i].y === head.y) {
                    return true;
                }
            }
            return false;
        }
        
        function checkOpponentCollision(player, head) {
            const opponent = player === gameState.player1 ? gameState.player2 : gameState.player1;
            
            for (const segment of opponent.snake) {
                if (segment.x === head.x && segment.y === head.y) {
                    return true;
                }
            }
            return false;
        }
        
        function checkFoodCollision(head) {
            return gameState.food.findIndex(food => food.x === head.x && food.y === head.y);
        }
        
        function createParticles(x, y, color) {
            for (let i = 0; i < 15; i++) {
                const angle = (Math.PI * 2 * i) / 15;
                const speed = 3 + Math.random() * 2;
                gameState.particles.push({
                    x: x,
                    y: y,
                    vx: Math.cos(angle) * speed,
                    vy: Math.sin(angle) * speed,
                    color: color,
                    life: 1,
                    size: 3 + Math.random() * 3
                });
            }
        }
        
        function updateParticles() {
            for (let i = gameState.particles.length - 1; i >= 0; i--) {
                const p = gameState.particles[i];
                p.x += p.vx;
                p.y += p.vy;
                p.life -= 0.02;
                
                if (p.life <= 0) {
                    gameState.particles.splice(i, 1);
                }
            }
        }
        
        function updateUI() {
            document.getElementById('p1-length').textContent = gameState.player1.snake.length;
            document.getElementById('p1-score').textContent = gameState.player1.score;
            document.getElementById('p1-food').textContent = gameState.player1.foodEaten;
            
            document.getElementById('p2-length').textContent = gameState.player2.snake.length;
            document.getElementById('p2-score').textContent = gameState.player2.score;
            document.getElementById('p2-food').textContent = gameState.player2.foodEaten;
        }
        
        function checkGameEnd() {
            if (!gameState.player1.alive || !gameState.player2.alive) {
                gameState.running = false;
                showGameOver();
            }
        }
        
        function showGameOver() {
            const p1 = gameState.player1;
            const p2 = gameState.player2;
            
            if (!p1.alive && !p2.alive) {
                winnerTitle.textContent = 'å¹³å±€ï¼';
                winnerTitle.style.color = '#FFE66D';
            } else if (!p1.alive) {
                winnerTitle.textContent = `${gameMode === 'ai' ? 'AI' : 'ç©å®¶ 2'} è·èƒœï¼`;
                winnerTitle.style.color = '#f72585';
            } else {
                winnerTitle.textContent = 'ç©å®¶ 1 è·èƒœï¼';
                winnerTitle.style.color = '#4cc9f0';
            }
            
            gameOverEl.style.borderColor = !p1.alive && !p2.alive ? '#FFE66D' : 
                                           !p1.alive ? '#f72585' : '#4cc9f0';
            gameOverEl.style.boxShadow = `0 0 60px ${!p1.alive && !p2.alive ? '#FFE66D' : 
                                                      !p1.alive ? '#f72585' : '#4cc9f0'}`;
            
            document.getElementById('final-p1-score').textContent = p1.score;
            document.getElementById('final-p1-length').textContent = p1.snake.length;
            document.getElementById('final-p2-score').textContent = p2.score;
            document.getElementById('final-p2-length').textContent = p2.snake.length;
            
            gameOverEl.classList.add('show');
        }
        
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            ctx.strokeStyle = 'rgba(255, 255, 255, 0.05)';
            ctx.lineWidth = 1;
            for (let i = 0; i <= COLS; i++) {
                ctx.beginPath();
                ctx.moveTo(i * CELL_SIZE, 0);
                ctx.lineTo(i * CELL_SIZE, canvas.height);
                ctx.stroke();
            }
            for (let i = 0; i <= ROWS; i++) {
                ctx.beginPath();
                ctx.moveTo(0, i * CELL_SIZE);
                ctx.lineTo(canvas.width, i * CELL_SIZE);
                ctx.stroke();
            }
            
            for (const food of gameState.food) {
                ctx.fillStyle = food.color;
                ctx.shadowBlur = 15;
                ctx.shadowColor = food.color;
                ctx.beginPath();
                ctx.arc(food.x * CELL_SIZE + CELL_SIZE / 2, 
                       food.y * CELL_SIZE + CELL_SIZE / 2, 
                       CELL_SIZE / 2 - 2, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.shadowBlur = 0;
            
            drawSnake(gameState.player1);
            drawSnake(gameState.player2);
            
            for (const p of gameState.particles) {
                ctx.fillStyle = p.color;
                ctx.globalAlpha = p.life;
                ctx.beginPath();
                ctx.arc(p.x, p.y, p.size, 0, Math.PI * 2);
                ctx.fill();
            }
            ctx.globalAlpha = 1;
        }
        
        function drawSnake(player) {
            if (!player.alive) return;
            
            for (let i = 0; i < player.snake.length; i++) {
                const segment = player.snake[i];
                const alpha = 1 - (i / player.snake.length) * 0.5;
                
                ctx.fillStyle = player.color;
                ctx.globalAlpha = alpha;
                ctx.shadowBlur = 10;
                ctx.shadowColor = player.color;
                
                ctx.fillRect(segment.x * CELL_SIZE + 2, 
                           segment.y * CELL_SIZE + 2, 
                           CELL_SIZE - 4, 
                           CELL_SIZE - 4);
                
                if (i === 0) {
                    ctx.fillStyle = 'white';
                    ctx.shadowBlur = 0;
                    ctx.beginPath();
                    ctx.arc(segment.x * CELL_SIZE + CELL_SIZE / 2 - 3, 
                           segment.y * CELL_SIZE + CELL_SIZE / 2 - 3, 
                           2, 0, Math.PI * 2);
                    ctx.arc(segment.x * CELL_SIZE + CELL_SIZE / 2 + 3, 
                           segment.y * CELL_SIZE + CELL_SIZE / 2 - 3, 
                           2, 0, Math.PI * 2);
                    ctx.fill();
                }
            }
            
            ctx.globalAlpha = 1;
            ctx.shadowBlur = 0;
        }
        
        function gameLoop() {
            if (!gameState.running || gameState.paused) return;
            
            aiMove();
            moveSnake(gameState.player1);
            moveSnake(gameState.player2);
            updateParticles();
            updateUI();
            checkGameEnd();
            draw();
            
            setTimeout(() => requestAnimationFrame(gameLoop), 100);
        }
    </script>
</body>
</html>
